clear
close all
%%%%%%%%%%%%%%%%%%%%%%%%%%
FS = 18;
set(0,'defaultlinelinewidth',3)
set(0,'DefaultAxesFontSize',FS)
set(0,'DefaultTextFontSize',FS)

load Qeff_vs_Pinc_475_550_625; 

figure('position',[300, 700, 1500, 400]); clf;
subplot(122);
plot(xi,z0, xi,y2,'--');
xlim([0 2]);
ylim([0 0.1])
grid on;
xlabel('{\it{P}}_{inc} (nW)');
ylabel('{\it{Q}}_{eff}');
legend('Fixed-{\it{T}} Model', '{\it{T}}-Dependent Model')
text(-8,0.105,'(b)','FontSize',FS+4)
text(-73,0.105,'(a)','FontSize',FS+4)

% bare mos2 results
load bare_mos2_Ey; %  xi Ei

% reflectance results
R = [0.4500000109395891	0.6275545954704285
0.45500001106114013	0.6256977915763855
0.4600000111826911	0.6219612956047058
0.4650000113042421	0.6169512867927551
0.47000001142579306	0.6106274127960205
0.47500001154734406	0.6033393740653992
0.480000012	0.5952939391136169
0.48500001179044594	0.5863097906112671
0.490000012	0.5767605304718018
0.49500001203354804	0.5662398934364319
0.5000000121550989	0.5548991560935974
0.505000012	0.5426703691482544
0.5100000123982009	0.5292003154754639
0.515000013	0.5147117376327515
0.520000013	0.4988991618156433
0.525000013	0.4815808832645416
0.530000013	0.4629374146461487
0.5350000130059559	0.4426353871822357
0.5400000131275069	0.4206010401248932
0.5450000132490579	0.3970426321029663
0.5500000133706089	0.37175342440605164
0.5550000134921598	0.3447791635990143
0.5600000136137109	0.3165442645549774
0.5650000137352618	0.2872393727302551
0.5700000138568128	0.25730475783348083
0.5750000139783638	0.2278074324131012
0.5800000140999148	0.20001038908958435
0.5850000142214657	0.1756173074245453
0.5900000143430167	0.15728293359279633
0.5950000144645677	0.14817360043525696
0.6000000145861187	0.1511256843805313
0.6050000147076697	0.1669820100069046
0.6100000148292207	0.19131775200366974
0.6150000149507717	0.21320389211177826
0.6200000150723227	0.22071367502212524
0.6250000151938737	0.20980948209762573
0.6300000153154247	0.1872105747461319
0.6350000154369757	0.16433632373809814
0.6400000155585267	0.14973360300064087
0.6450000156800777	0.14707708358764648
0.6500000158016286	0.15692691504955292
0.6550000159231797	0.17663225531578064
0.6600000160447306	0.19832272827625275
0.6650000161662817	0.21014241874217987
0.6700000162878326	0.20272265374660492
0.6750000164093837	0.17591677606105804
0.6800000165309346	0.13935692608356476
0.6850000166524856	0.10621695965528488
0.6900000167740366	0.085695788
0.6950000168955875	0.079878382
0.7000000170171385	0.085816443];


subplot(121);
[AX, H1, H2] = plotyy(R(1:41,1)*1e3, R(1:41,2),xi,Ei);
xlim(AX(1),[450 650])
xlim(AX(2),[450 650])
ylabel(AX(1), 'Reflectance');
ylabel(AX(2), '|{\it{E}}_y| (a.u.)');
set(H1,'linewidth',2);
set(H2,'linestyle','--','linewidth',2);
text(420, 0.82, '(a)', 'FontSize',FS+4);
text(675, 0.82, '(b)', 'FontSize',FS+4);
grid on;
xlabel('\lambda (nm)');
legend('Reflectance','|{\it{E}}_y|','Location','East')